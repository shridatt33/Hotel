<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0891b2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Guest Verification | {{ hotel_name or 'HotelEase' }}</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='guest_verification.css') }}">
</head>
<body>
    <div class="form-container">
        <!-- Header -->
        <div class="form-header">
            <div class="logo-container">
                <i class="fas fa-user-check"></i>
            </div>
            <h1>Guest Verification</h1>
            <p class="subtitle">Complete your identity verification</p>
            {% if hotel_name %}
            <div class="hotel-badge">
                <i class="fas fa-hotel"></i>
                {{ hotel_name }}
            </div>
            {% endif %}
        </div>
        
        <!-- Progress Steps (visual indicator) -->
        <div class="progress-steps">
            <div class="step active"></div>
            <div class="step"></div>
            <div class="step"></div>
        </div>
        
        <!-- Form Body -->
        <div class="form-body">
            {% if error %}
            <div class="error-message error-shake">
                <i class="fas fa-exclamation-circle"></i>
                <div>{{ error }}</div>
            </div>
            {% endif %}
            
            <form action="{{ url_for('guest_verification.submit_verification', manager_id=manager_id) }}" method="POST" enctype="multipart/form-data" id="verificationForm">
                <!-- Full Name -->
                <div class="form-group">
                    <label for="guest_name">
                        <i class="fas fa-user"></i>
                        Full Name <span class="required">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="guest_name"
                        name="guest_name" 
                        required 
                        placeholder="Enter your full name as per ID"
                        autocomplete="name"
                        autofocus
                    >
                </div>
                
                <!-- Phone Number -->
                <div class="form-group">
                    <label for="phone">
                        <i class="fas fa-phone"></i>
                        Phone Number <span class="required">*</span>
                    </label>
                    <input 
                        type="tel" 
                        id="phone"
                        name="phone" 
                        required 
                        placeholder="Enter 10-digit mobile number"
                        pattern="[0-9]{10}" 
                        inputmode="numeric"
                        title="Enter a valid 10-digit phone number"
                        autocomplete="tel"
                    >
                    <div class="input-hint">
                        <i class="fas fa-info-circle"></i>
                        10 digit mobile number without country code
                    </div>
                </div>
                
                <!-- Address -->
                <div class="form-group">
                    <label for="address">
                        <i class="fas fa-map-marker-alt"></i>
                        Complete Address <span class="required">*</span>
                    </label>
                    <textarea 
                        id="address"
                        name="address" 
                        required 
                        placeholder="Enter your full address including city, state, and postal code"
                        rows="3"
                        autocomplete="street-address"
                    ></textarea>
                </div>
                
                <!-- Government ID Number -->
                <div class="form-group">
                    <label for="kyc_number">
                        <i class="fas fa-id-card"></i>
                        Government ID Number <span class="required">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="kyc_number"
                        name="kyc_number" 
                        required 
                        placeholder="Aadhaar, Passport, or Driver's License Number"
                    >
                    <div class="input-hint">
                        <i class="fas fa-info-circle"></i>
                        Any valid government issued ID
                    </div>
                </div>
                
                <!-- File Upload -->
                <div class="form-group">
                    <label>
                        <i class="fas fa-camera"></i>
                        Upload Identity Document <span class="required">*</span>
                    </label>
                    <div class="file-upload-wrapper">
                        <div class="file-upload-area" id="fileUploadArea">
                            <input 
                                type="file" 
                                name="identity_file" 
                                id="identity_file"
                                accept="image/*,.pdf" 
                                required
                                capture="environment"
                            >
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt" id="uploadIcon"></i>
                            </div>
                            <div class="upload-text" id="uploadText">Tap to upload or take photo</div>
                            <div class="upload-hint">Image or PDF up to 10MB</div>
                            <div class="file-name" id="fileName"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Submit Button -->
                <button type="submit" class="submit-btn" id="submitBtn">
                    <span class="loading" id="loadingState">
                        <i class="fas fa-spinner"></i>
                        Submitting...
                    </span>
                    <span class="btn-text" id="btnText">
                        <i class="fas fa-paper-plane"></i>
                        Submit Verification
                    </span>
                </button>
            </form>
        </div>
        
        <!-- Footer -->
        <div class="form-footer">
            <div class="security-badge">
                <i class="fas fa-shield-alt"></i>
                Your information is secure and encrypted
            </div>
        </div>
    </div>
    
    <script>
        // File Upload Handling
        const fileInput = document.getElementById('identity_file');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const uploadIcon = document.getElementById('uploadIcon');
        const uploadText = document.getElementById('uploadText');
        const fileName = document.getElementById('fileName');
        
        fileInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                const fileSize = (file.size / 1024 / 1024).toFixed(2);
                fileUploadArea.classList.add('has-file');
                uploadIcon.className = 'fas fa-check';
                uploadText.textContent = 'File selected';
                fileName.textContent = `${file.name} (${fileSize} MB)`;
            }
        });
        
        // Drag and drop support
        fileUploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
        });
        
        fileUploadArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
        });
        
        fileUploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
        });
        
        // Form Submission
        const form = document.getElementById('verificationForm');
        const submitBtn = document.getElementById('submitBtn');
        const loadingState = document.getElementById('loadingState');
        const btnText = document.getElementById('btnText');
        
        form.addEventListener('submit', function() {
            submitBtn.disabled = true;
            loadingState.classList.add('show');
        });
        
        // Phone number formatting
        const phoneInput = document.getElementById('phone');
        phoneInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '').substring(0, 10);
        });
        
        // Update progress steps on input
        const inputs = document.querySelectorAll('input, textarea');
        const steps = document.querySelectorAll('.step');
        
        function updateProgress() {
            let filledCount = 0;
            inputs.forEach(input => {
                if (input.value.trim() || (input.type === 'file' && input.files.length > 0)) {
                    filledCount++;
                }
            });
            
            const progress = Math.floor((filledCount / inputs.length) * 3);
            steps.forEach((step, index) => {
                step.classList.toggle('active', index <= progress);
            });
        }
        
        inputs.forEach(input => {
            input.addEventListener('input', updateProgress);
            input.addEventListener('change', updateProgress);
        });
    </script>
</body>
</html>